<script type="text/Javascript">
var first = true;
Array.prototype.max = function() {
	return Math.max.apply(Math, this);
};
Array.prototype.min = function() {
	return Math.min.apply(Math, this);
};

var numsolves = 0;
var totalt = new Array();
var totalts = new Array();
var totaltpss = new Array();
var totalte = new Array();
var totaltpse = new Array();
var cross1t = new Array();
var cross1ts = new Array();
var cross1tpss = new Array();
var cross1te = new Array();
var cross1tpse = new Array();
var layert = new Array();
var layerts = new Array();
var layertpss = new Array();
var layerte = new Array();
var layertpse = new Array();
var llayert = new Array();
var llayerts = new Array();
var llayertpss = new Array();
var llayerte = new Array();
var llayertpse = new Array();

var rows = 9;

function replace() {
	document.getElementById("text").innerHTML = trim(get('s1m')) + " // inspection";
	var numturns = 0;
	for (i = 2; i < rows; i++) {
		numturns += get('s' + i + 'ts') * 1;
		if (document.getElementById("r" + i).style.display != "none") {
			document.getElementById("text").innerHTML += "<br/>" + trim(get('s' + i + 'm')) + " // " + get('s' + i + 'n');
		}
	}

	function trim(s) {
		s = s.replace(/(^\s*)|(\s*$)/gi, "");
		s = s.replace(/[ ]{2,}/gi, " ");
		s = s.replace(/\n /, "\n");
		return s;
	}

	var str = document.getElementById("text").innerHTML;
	str = str.replace(/'/g, "-");
	str = str.replace(/ /g, "_");
	str = str.replace(/<br>/g, "%0A");
	var scr = document.getElementById("scr").value;
	scr = scr.replace(/'/g, "-");
	scr = scr.replace(/ /g, "_");
	var avg = document.getElementById("avsel").value;
	var avgtime = document.getElementById("av").value;
	var solver = document.getElementById("solver").value;

	document.getElementById("offic").checked == 0 ? official = "%20(unofficial)" : official = "%20(official)";
	var solvenum = document.getElementById('sn').value;
	var solvenumsu = solvenum + getsuffix(solvenum);
	solvenum = '%20(' + solvenumsu + '%20solve)';
	if (avg != 0) {
		var titlename = solver + '%20-%20' + avgtime + '%203x3%20av' + avg + official + solvenum;
	}
	if (avg == 0) {
		var titlename = solver + '%20-%20' + avgtime + '%203x3%20single' + official
	}
	document.getElementById("encode").innerHTML = "http://alg.cubing.net/?alg=" + str + "&title=" + titlename + "&setup=" + trim(scr);
	document.getElementById("link").innerHTML = "[COLOR=\"#696969\"]View at [URL=\"http://alg.cubing.net?alg=" + str + "&title=" + titlename + "&setup=" + trim(scr) + "\"]<a target='_blank' href='http://alg.cubing.net/?alg=" + str + "&title=" + titlename + "&setup=" + trim(scr) + "'>alg.cubing.net</a>[/URL][/COLOR]";
}

var xc = 1;

function altstep() {
	var vid = document.getElementById("vid").checked;
	if (vid == true) {
		document.getElementById("utube").style.display = "";
	}
	if (vid == false) {
		document.getElementById("utube").style.display = "none";
		document.getElementById("youtube").value = "Full URL";
	}
	var oll = document.getElementById("oskip").checked;
	if (oll == true) {
		document.getElementById("r7").style.display = "none";
		document.getElementById("llt2").style.display = "";
		document.getElementById("s7m").value = "";
		document.getElementById("s7t").value = "0";
	}
	if (oll == false) {
		document.getElementById("r7").style.display = "";
		document.getElementById("llt2").style.display = "none";
		document.getElementById("s8t").value = "0";
	}

	var pll = document.getElementById("pskip").checked;
	if (pll == true) {
		document.getElementById("r8").style.display = "none";
		document.getElementById("s8m").value = "";
		document.getElementById("s8t").value = "0";
		document.getElementById("oborder").style.borderBottom = "1px solid black";
	}
	if (pll == false) {
		document.getElementById("r8").style.display = "";
		document.getElementById("oborder").style.borderBottom = "";
	}

	var cross = document.getElementById("tcross").value;
	if (cross == "n") {
		document.getElementById("r3").style.display = "";
		document.getElementById("r4").style.display = "";
		document.getElementById("r5").style.display = "";
		document.getElementById("s2n").value = "cross";
		document.getElementById("xborder").style.borderBottom = "";
		document.getElementById("c").rowSpan = 2;
		document.getElementById("f2").style.display = "";
		document.getElementById("f3").style.display = "none";
		document.getElementById("f4").style.display = "none";
		xc = 1;
	}
	if (cross == "x") {
		document.getElementById("r3").style.display = "none";
		document.getElementById("r4").style.display = "";
		document.getElementById("r5").style.display = "";
		document.getElementById("s2n").value = "Xcross";
		document.getElementById("s3m").value = "";
		document.getElementById("xborder").style.borderBottom = "1px solid black";
		document.getElementById("c").rowSpan = 1;
		document.getElementById("f2").style.display = "";
		document.getElementById("f3").style.display = "none";
		document.getElementById("f4").style.display = "none";
		xc = 1;
	}
	if (cross == "xx") {
		document.getElementById("r3").style.display = "none";
		document.getElementById("r4").style.display = "none";
		document.getElementById("r5").style.display = "";
		document.getElementById("s2n").value = "XXcross";
		document.getElementById("s3m").value = "";
		document.getElementById("s4m").value = "";
		document.getElementById("xborder").style.borderBottom = "1px solid black";
		document.getElementById("c").rowSpan = 1;
		document.getElementById("f2").style.display = "none";
		document.getElementById("f3").style.display = "";
		document.getElementById("f4").style.display = "none";
		xc = 2;
	}
	if (cross == "xxx") {
		document.getElementById("r3").style.display = "none";
		document.getElementById("r4").style.display = "none";
		document.getElementById("r5").style.display = "none";
		document.getElementById("s2n").value = "XXXcross";
		document.getElementById("s3m").value = "";
		document.getElementById("s4m").value = "";
		document.getElementById("s5m").value = "";
		document.getElementById("xborder").style.borderBottom = "1px solid black";
		document.getElementById("c").rowSpan = 1;
		document.getElementById("f2").style.display = "none";
		document.getElementById("f3").style.display = "none";
		document.getElementById("f4").style.display = "";
		xc = 3;
	}

	generate();
}

function countetm() {
	for (i = 2; i < rows; i++) {
		var rota = document.getElementById("s" + i + "m").value.toLowerCase();
		var r = rota.split("r").length - 1;
		var l = rota.split("l").length - 1;
		var u = rota.split("u").length - 1;
		var f = rota.split("f").length - 1;
		var b = rota.split("b").length - 1;
		var d = rota.split("d").length - 1;
		var m = rota.split("m").length - 1;
		var n = rota.split("n").length - 1;
		var e = rota.split("e").length - 1;
		var s = rota.split("s").length - 1;
		var x = rota.split("x").length - 1;
		var y = rota.split("y").length - 1;
		var z = rota.split("z").length - 1;
		var etm = r + l + u + d + f + b + m + n + e + s + x + y + z;
		document.getElementById("s" + i + "te").value = etm;
	}
	countstm();
}

function countstm() {
	for (i = 2; i < rows; i++) {
		var rota = document.getElementById("s" + i + "m").value.toLowerCase();
		var r = rota.split("r").length - 1;
		var l = rota.split("l").length - 1;
		var u = rota.split("u").length - 1;
		var f = rota.split("f").length - 1;
		var b = rota.split("b").length - 1;
		var d = rota.split("d").length - 1;
		var m = rota.split("m").length - 1;
		var n = rota.split("n").length - 1;
		var e = rota.split("e").length - 1;
		var s = rota.split("s").length - 1;
		if (document.getElementById("hstm").value == "HTM") {
			var stm = r + l + u + d + f + b + (m + n + e + s) * 2;
		}
		if (document.getElementById("hstm").value == "STM") {
			var stm = r + l + u + d + f + b + m + n + e + s;
		}
		document.getElementById("s" + i + "ts").value = stm;
	}
}

function get(s2n) {
	var n = document.getElementById(s2n).value;
	return n;
}

function generate() {
	for (i = 1; i < rows; i++) {
		document.getElementById("s" + i + "m").value = document.getElementById("s" + i + "m").value.replace(/`/g, "'");
		document.getElementById("s" + i + "m").value = document.getElementById("s" + i + "m").value.replace(/’/g, "'");
	}
	var numturns = 0;
	var numturnse = 0;
	var scr = get('scr');
	var s = "<br/><br/>" + get('s1m') + " <span style='color:#696969'>[COLOR=\"#696969\"]// inspection[/COLOR]</span>";
	for (i = 2; i < rows; i++) {
		numturns += get('s' + i + 'ts') * 1;
		numturnse += get('s' + i + 'te') * 1;
		var stps = Math.round(get('s' + i + 'ts') / get('s' + i + 't') * 100) / 100;
		var etps = Math.round(get('s' + i + 'te') / get('s' + i + 't') * 100) / 100;
		var n = document.getElementById("r" + i).style.display;
		if (n != "none") {
			s += "<br/>" + get('s' + i + 'm') + " <span style='color:#696969'>[COLOR=\"#696969\"]// " + get('s' + i + 'n') + "[/COLOR]</span>";
		}
	}

	var c1ts = get('s2ts') * 1 + get('s3ts') * 1;
	var c1te = get('s2te') * 1 + get('s3te') * 1;
	var c1t = (get('s2t') * 1 + get('s3t') * 1).toFixed(2);
	var c1tpss = (Math.round(c1ts * 100 / c1t) / 100).toFixed(2);
	var c1tpse = (Math.round(c1te * 100 / c1t) / 100).toFixed(2);
	var f2lts = c1ts + get('s4ts') * 1 + get('s5ts') * 1 + get('s6ts') * 1;
	var f2lte = c1te + get('s4te') * 1 + get('s5te') * 1 + get('s6te') * 1
	var f2lt = (get('s4t') * 1 + get('s5t') * 1 + get('s6t') * 1).toFixed(2);
	var f2ltpss = (Math.round(f2lts * 100 / f2lt) / 100).toFixed(2);
	var f2ltpse = (Math.round(f2lte * 100 / f2lt) / 100).toFixed(2);
	var llts = get('s7ts') * 1 + get('s8ts') * 1;
	var llte = get('s7te') * 1 + get('s8te') * 1;
	var llt = (get('s7t') * 1 + get('s8t') * 1 - f2lt * 1).toFixed(2);
	var lltpss = (Math.round(llts * 100 / llt) / 100).toFixed(2);
	var lltpse = (Math.round(llte * 100 / llt) / 100).toFixed(2);
	var totaltime = ((f2lt * 1) + (llt * 1)).toFixed(2);
	var ttpss = (Math.round(numturns * 100 / totaltime) / 100).toFixed(2);
	var ttpse = (Math.round(numturnse * 100 / totaltime) / 100).toFixed(2);
	if (c1t == 0) {
		c1tpss = 0;
		c1tpse = 0;
		c1ts = 0;
		c1te = 0;
	}
	if (f2lt == 0) {
		f2ltpss = 0;
		f2ltpse = 0;
		f2lts = 0;
		f2lte = 0;
	}
	if (llt == 0) {
		lltpss = 0;
		lltpse = 0;
		llts = 0;
		llte = 0;
	}

	if (document.getElementById("vid").checked == true && numsolves == 0) {
		document.getElementById("post").innerHTML = "[SPOILER=\"Video\"][youtubehd]" + getstuff('v') + "[/youtubehd][/SPOILER][SPOILER=\"" + get('sn') + getsuffix(get('sn')) + " solve\"]" + scr + s;
	} else {
		document.getElementById("post").innerHTML = "[SPOILER='" + get('sn') + getsuffix(get('sn')) + " solve']" + scr + s;
	}
	document.getElementById("stats").innerHTML = '[CODE]<style type="text/CSS">td{ width:60px; height:1em; }</style><table style="font-family:monospace;"><tr style="font-weight:bold;"><td>[b]Step</td><td>Time</td><td>' + document.getElementById("hstm").value + '</td><td>' + document.getElementById("hstm").value.substring(0, 1) + 'TPS</td><td>ETM</td><td>ETPS[/b]</td></tr><tr style="color:red;"><td>[COLOR=\"red\"]Total</td><td>' + (Math.round(totaltime * 100) / 100).toFixed(2) + '</td><td>' + numturns + '</td><td>' + (Math.round(ttpss * 100) / 100).toFixed(2) + '</td><td>' + numturnse + '</td><td>' + (Math.round(ttpse * 100) / 100).toFixed(2) + '[/COLOR]</td></tr></table><br/><table style="font-family:monospace;"><tr><td>Cross+' + xc + '</td><td>' + (Math.round(c1t * 100) / 100).toFixed(2) + '</td><td>' + c1ts + '</td><td>' + (Math.round(c1tpss * 100) / 100).toFixed(2) + '</td><td>' + c1te + '</td><td>' + (Math.round(c1tpse * 100) / 100).toFixed(2) + '</td></tr><tr><td>F2L</td><td>' + (Math.round(f2lt * 100) / 100).toFixed(2) + '</td><td>' + f2lts + '</td><td>' + (Math.round(f2ltpss * 100) / 100).toFixed(2) + '</td><td>' + f2lte + '</td><td>' + (Math.round(f2ltpse * 100) / 100).toFixed(2) + '</td></tr><tr><td>LL</td><td>' + (Math.round(llt * 100) / 100).toFixed(2) + '</td><td>' + llts + '</td><td>' + (Math.round(lltpss * 100) / 100).toFixed(2) + '</td><td>' + llte + '</td><td>' + (Math.round(lltpse * 100) / 100).toFixed(2) + '</td></tr></table>';
	document.getElementById("stats").innerHTML += '<br/><table style="font-family:monospace;"><tr style="font-weight:bold;"><td>[b]Step</td><td></td><td>Time</td><td>' + document.getElementById("hstm").value + '</td><td>ETM[/b]</td></tr><tr><td colspan="2">Cross+' + xc + '/F2L</td><td>' + Math.round(c1t * 100 / f2lt) + '%</td><td>' + Math.round(c1ts * 100 / f2lts) + '%</td><td>' + Math.round(c1te * 100 / f2lte) + '%</td></tr><tr><td colspan="2">F2L/Total</td><td>' + Math.round(f2lt * 100 / totaltime) + '%</td><td>' + Math.round(f2lts * 100 / numturns) + '%</td><td>' + Math.round(f2lte * 100 / numturnse) + '%</td></tr><tr><td colspan="2">LL/Total</td><td>' + Math.round(llt * 100 / totaltime) + '%</td><td>' + Math.round(llts * 100 / numturns) + '%</td><td>' + Math.round(llte * 100 / numturnse) + '%</td></tr></table>[/CODE][/SPOILER]';
	var solver = document.getElementById("solver").value;
	var avg = document.getElementById("avsel").value;
	var avgtime = document.getElementById("av").value;
	document.getElementById("offic").checked == 0 ? official = " (unofficial)" : official = " (official)";
	if (avg != 0) {
		document.getElementById("prespoil").innerHTML = solver + ' - ' + avgtime + ' 3x3 av' + avg + official + '<br/><br/>';
	}
	if (avg == 0) {
		document.getElementById("prespoil").innerHTML = '';
	}
	replace();
}

function selectText() {
	if (document.selection) {
		var range = document.body.createTextRange();
		range.moveToElementText(document.getElementById('full'));
		range.select();
	} else if (window.getSelection) {
		var range = document.createRange();
		range.selectNode(document.getElementById('full'));
		window.getSelection().addRange(range);
	}
}

function addsolve() {
	var r2 = l2 = u2 = f2 = b2 = d2 = m2 = n2 = e2 = s2 = x2 = y2 = z2 = 0;
	for (i = 2; i < rows; i++) {
		var rota2 = document.getElementById("s" + i + "m").value.toLowerCase();
		r2 += rota2.split("r").length - 1;
		l2 += rota2.split("l").length - 1;
		u2 += rota2.split("u").length - 1;
		f2 += rota2.split("f").length - 1;
		b2 += rota2.split("b").length - 1;
		d2 += rota2.split("d").length - 1;
		m2 += rota2.split("m").length - 1;
		n2 += rota2.split("n").length - 1;
		e2 += rota2.split("e").length - 1;
		s2 += rota2.split("s").length - 1;
		x2 += rota2.split("x").length - 1;
		y2 += rota2.split("y").length - 1;
		z2 += rota2.split("z").length - 1;
		if (document.getElementById("hstm").value == "HTM") {
			var stm2 = r2 + l2 + u2 + d2 + f2 + b2 + (m2 + n2 + e2 + s2) * 2;
		}
		if (document.getElementById("hstm").value == "STM") {
			var stm2 = r2 + l2 + u2 + d2 + f2 + b2 + m2 + n2 + e2 + s2;
		}
		var etm2 = r2 + l2 + u2 + d2 + f2 + b2 + m2 + n2 + e2 + s2 + x2 + y2 + z2;
	}

	var c1t2 = (get('s2t') * 1 + get('s3t') * 1).toFixed(2);
	var f2lt2 = (get('s4t') * 1 + get('s5t') * 1 + get('s6t') * 1).toFixed(2);
	var llt2 = (get('s7t') * 1 + get('s8t') * 1 - f2lt2 * 1).toFixed(2);
	var totaltime2 = ((f2lt2 * 1) + (llt2 * 1)).toFixed(2);
	totalt.push(totaltime2);
	totalts.push(stm2);
	totaltpss.push(stm2 / totaltime2);
	totalte.push(etm2);
	totaltpse.push(etm2 / totaltime2);
	var a3 = b3 = c3 = d3 = e3 = 0;
	for (i = 0; i < totalt.length; i++) {
		a3 += totalt[i] * 1;
		b3 += totalts[i] * 1;
		c3 += totaltpss[i] * 1;
		d3 += totalte[i] * 1;
		e3 += totaltpse[i] * 1;
	}
	a3 = (a3 - totalt.max() - totalt.min()) / (totalt.length - 2);
	b3 = (b3 - totalts.max() - totalts.min()) / (totalts.length - 2);
	c3 = (c3 - totaltpss.max() - totaltpss.min()) / (totaltpss.length - 2);
	d3 = (d3 - totalte.max() - totalte.min()) / (totalte.length - 2);
	e3 = (e3 - totaltpse.max() - totaltpse.min()) / (totaltpse.length - 2);

	if (numsolves > 1) {
		document.getElementById("statsa").innerHTML = '[SPOILER="Stats"][CODE]<style type="text/CSS">td{ width:60px; height:1em; }</style><table style="font-family:monospace;"><tr style="font-weight:bold;"><td>[b]Step</td><td>Time</td><td>' + document.getElementById("hstm").value + '</td><td>' + document.getElementById("hstm").value.substring(0, 1) + 'TPS</td><td>ETM</td><td>ETPS[/b]</td></tr><tr style="color:red;"><td>[COLOR=\"red\"]Total</td><td>' + (Math.round(a3 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(b3 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(c3 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(d3 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(e3 * 100) / 100).toFixed(2) + '[/COLOR]</td></tr></table>';
	}

	var r4 = l4 = u4 = f4 = b4 = d4 = m4 = n4 = e4 = s4 = x4 = y4 = z4 = 0;
	for (i = 2; i < (rows - 5); i++) {
		var rota4 = document.getElementById("s" + i + "m").value.toLowerCase();
		r4 += rota4.split("r").length - 1;
		l4 += rota4.split("l").length - 1;
		u4 += rota4.split("u").length - 1;
		f4 += rota4.split("f").length - 1;
		b4 += rota4.split("b").length - 1;
		d4 += rota4.split("d").length - 1;
		m4 += rota4.split("m").length - 1;
		n4 += rota4.split("n").length - 1;
		e4 += rota4.split("e").length - 1;
		s4 += rota4.split("s").length - 1;
		x4 += rota4.split("x").length - 1;
		y4 += rota4.split("y").length - 1;
		z4 += rota4.split("z").length - 1;
		if (document.getElementById("hstm").value == "HTM") {
			var stm4 = r4 + l4 + u4 + d4 + f4 + b4 + (m4 + n4 + e4 + s4) * 2;
		}
		if (document.getElementById("hstm").value == "STM") {
			var stm4 = r4 + l4 + u4 + d4 + f4 + b4 + m4 + n4 + e4 + s4;
		}
		var etm4 = r4 + l4 + u4 + d4 + f4 + b4 + m4 + n4 + e4 + s4 + x4 + y4 + z4;
	}

	cross1t.push(c1t2);
	cross1ts.push(stm4);
	cross1tpss.push(stm4 / c1t2);
	cross1te.push(etm4);
	cross1tpse.push(etm4 / c1t2);
	var a5 = b5 = c5 = d5 = e5 = 0;
	for (i = 0; i < totalt.length; i++) {
		a5 += cross1t[i] * 1;
		b5 += cross1ts[i] * 1;
		c5 += cross1tpss[i] * 1;
		d5 += cross1te[i] * 1;
		e5 += cross1tpse[i] * 1;
	}
	a5 = (a5 - cross1t.max() - cross1t.min()) / (cross1t.length - 2);
	b5 = (b5 - cross1ts.max() - cross1ts.min()) / (cross1ts.length - 2);
	c5 = (c5 - cross1tpss.max() - cross1tpss.min()) / (cross1tpss.length - 2);
	d5 = (d5 - cross1te.max() - cross1te.min()) / (cross1te.length - 2);
	e5 = (e5 - cross1tpse.max() - cross1tpse.min()) / (cross1tpse.length - 2);

	if (numsolves > 1) {
		document.getElementById("statsa").innerHTML += '<br/><table style="font-family:monospace;"><tr><td>Cross+1</td><td>' + (Math.round(a5 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(b5 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(c5 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(d5 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(e5 * 100) / 100).toFixed(2) + '</td></tr></table>';
	}

	var r6 = l6 = u6 = f6 = b6 = d6 = m6 = n6 = e6 = s6 = x6 = y6 = z6 = 0;
	for (i = 2; i < rows - 2; i++) {
		var rota6 = document.getElementById("s" + i + "m").value.toLowerCase();
		r6 += rota6.split("r").length - 1;
		l6 += rota6.split("l").length - 1;
		u6 += rota6.split("u").length - 1;
		f6 += rota6.split("f").length - 1;
		b6 += rota6.split("b").length - 1;
		d6 += rota6.split("d").length - 1;
		m6 += rota6.split("m").length - 1;
		n6 += rota6.split("n").length - 1;
		e6 += rota6.split("e").length - 1;
		s6 += rota6.split("s").length - 1;
		x6 += rota6.split("x").length - 1;
		y6 += rota6.split("y").length - 1;
		z6 += rota6.split("z").length - 1;
		if (document.getElementById("hstm").value == "HTM") {
			var stm6 = r6 + l6 + u6 + d6 + f6 + b6 + (m6 + n6 + e6 + s6) * 2;
		}
		if (document.getElementById("hstm").value == "STM") {
			var stm6 = r6 + l6 + u6 + d6 + f6 + b6 + m6 + n6 + e6 + s6;
		}
		var etm6 = r6 + l6 + u6 + d6 + f6 + b6 + m6 + n6 + e6 + s6 + x6 + y6 + z6;
	}

	layert.push(f2lt2);
	layerts.push(stm6);
	layertpss.push(stm6 / f2lt2);
	layerte.push(etm6);
	layertpse.push(etm6 / f2lt2);
	var a7 = b7 = c7 = d7 = e7 = 0;
	for (i = 0; i < totalt.length; i++) {
		a7 += layert[i] * 1;
		b7 += layerts[i] * 1;
		c7 += layertpss[i] * 1;
		d7 += layerte[i] * 1;
		e7 += layertpse[i] * 1;
	}
	a7 = (a7 - layert.max() - layert.min()) / (layert.length - 2);
	b7 = (b7 - layerts.max() - layerts.min()) / (layerts.length - 2);
	c7 = (c7 - layertpss.max() - layertpss.min()) / (layertpss.length - 2);
	d7 = (d7 - layerte.max() - layerte.min()) / (layerte.length - 2);
	e7 = (e7 - layertpse.max() - layertpse.min()) / (layertpse.length - 2);

	if (numsolves > 1) {
		document.getElementById("statsa").innerHTML += '<table style="font-family:monospace;"><tr><td>F2L</td><td>' + (Math.round(a7 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(b7 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(c7 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(d7 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(e7 * 100) / 100).toFixed(2) + '</td></tr></table>';
	}

	var r8 = l8 = u8 = f8 = b8 = d8 = m8 = n8 = e8 = s8 = x8 = y8 = z8 = 0;
	for (i = rows - 2; i < rows; i++) {
		var rota8 = document.getElementById("s" + i + "m").value.toLowerCase();
		r8 += rota8.split("r").length - 1;
		l8 += rota8.split("l").length - 1;
		u8 += rota8.split("u").length - 1;
		f8 += rota8.split("f").length - 1;
		b8 += rota8.split("b").length - 1;
		d8 += rota8.split("d").length - 1;
		m8 += rota8.split("m").length - 1;
		n8 += rota8.split("n").length - 1;
		e8 += rota8.split("e").length - 1;
		s8 += rota8.split("s").length - 1;
		x8 += rota8.split("x").length - 1;
		y8 += rota8.split("y").length - 1;
		z8 += rota8.split("z").length - 1;
		if (document.getElementById("hstm").value == "HTM") {
			var stm8 = r8 + l8 + u8 + d8 + f8 + b8 + (m8 + n8 + e8 + s8) * 2;
		}
		if (document.getElementById("hstm").value == "STM") {
			var stm8 = r8 + l8 + u8 + d8 + f8 + b8 + m8 + n8 + e8 + s8;
		}
		var etm8 = r8 + l8 + u8 + d8 + f8 + b8 + m8 + e8 + s8 + x8 + y8 + z8;
	}

	llayert.push(llt2);
	llayerts.push(stm8);
	llayertpss.push(stm8 / llt2);
	llayerte.push(etm8);
	llayertpse.push(etm8 / llt2);
	var a9 = b9 = c9 = d9 = e9 = 0;
	for (i = 0; i < totalt.length; i++) {
		a9 += llayert[i] * 1;
		b9 += llayerts[i] * 1;
		c9 += llayertpss[i] * 1;
		d9 += llayerte[i] * 1;
		e9 += llayertpse[i] * 1;
	}
	a9 = (a9 - llayert.max() - llayert.min()) / (llayert.length - 2);
	b9 = (b9 - llayerts.max() - llayerts.min()) / (llayerts.length - 2);
	c9 = (c9 - llayertpss.max() - llayertpss.min()) / (llayertpss.length - 2);
	d9 = (d9 - llayerte.max() - llayerte.min()) / (llayerte.length - 2);
	e9 = (e9 - llayertpse.max() - llayertpse.min()) / (llayertpse.length - 2);

	if (numsolves > 1) {
		document.getElementById("statsa").innerHTML += '<table style="font-family:monospace;"><tr><td>LL</td><td>' + (Math.round(a9 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(b9 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(c9 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(d9 * 100) / 100).toFixed(2) + '</td><td>' + (Math.round(e9 * 100) / 100).toFixed(2) + '</td></tr></table><br/><table style="font-family:monospace;"><tr style="font-weight:bold;"><td>[b]Step</td><td></td><td>Time</td><td>' + document.getElementById("hstm").value + '</td><td>ETM[/b]</td></tr><tr><td colspan="2">Cross+1/F2L</td><td>' + (Math.round(a5 * 100 / a7)).toFixed(2) + '%</td><td>' + (Math.round(b5 * 100 / b7)).toFixed(2) + '%</td><td>' + (Math.round(d5 * 100 / d7)).toFixed(2) + '%</td></tr><tr><td colspan="2">F2L/Total</td><td>' + (Math.round(a7 * 100 / a3)).toFixed(2) + '%</td><td>' + (Math.round(b7 * 100 / b3)).toFixed(2) + '%</td><td>' + (Math.round(d7 * 100 / d3)).toFixed(2) + '%</td></tr><tr><td colspan="2">LL/Total</td><td>' + (Math.round(a9 * 100 / a3)).toFixed(2) + '%</td><td>' + (Math.round(b9 * 100 / b3)).toFixed(2) + '%</td><td>' + (Math.round(d9 * 100 / d3)).toFixed(2) + '%</td></tr></table>[/CODE][/SPOILER]';
	}

	var sn = document.getElementById("sn").value * 1;
	document.getElementById("sn").value = sn + 1 * 1;

	document.getElementById("solves").innerHTML += document.getElementById('post').innerHTML + "<br/>" + document.getElementById('link').innerHTML + "<br/>" + document.getElementById('stats').innerHTML;
	for (i = 1; i < rows; i++) {
		document.getElementById("s" + i + "m").value = "";
		document.getElementById("s" + i + "t").value = "0";
		document.getElementById("s" + i + "ts").value = "0";
		document.getElementById("s" + i + "te").value = "0";
		document.getElementById("oskip").checked = "";
		document.getElementById("pskip").checked = "";
		document.getElementById("tcross").value = "n";
	}
	document.getElementById("hstm").disabled = "true";
	numsolves++;
	document.getElementById("final").innerHTML = document.getElementById("solves").innerHTML + document.getElementById("statsa").innerHTML;
	document.getElementById("vid").disabled = "true";
	document.getElementById("avsel").disabled = "true";
	document.getElementById("video").style.display = "none";
	document.getElementById("scr").value = "";
	document.getElementById("av").disabled = "true";
	document.getElementById("solver").disabled = "true";
	document.getElementById("offic").disabled = "true";
	altstep();
}

function visual() {
	var w = get('scr');
	for (i = 1; i < rows; i++) {
		w += document.getElementById('s' + i + 'm').value;
	}
	document.getElementById("visualcube").src = 'http://cube.crider.co.uk/visualcube.php?fmt=gif&size=150&co=0&fo=75&alg=x2' + w;
}

function getstuff(name) {
	name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
	var regexS = "[\\?&]" + name + "=([^&#]*)";
	var regex = new RegExp(regexS);
	var results = regex.exec(get('youtube'));
	if (results == null) return "";
	else return results[1];
}

function getsuffix(n) {
	n % 10 == 1 ? s = "st" : 0;
	n % 10 == 2 ? s = "nd" : 0;
	n % 10 == 3 ? s = "rd" : 0;
	n % 10 > 3 || n % 10 == 0 ? s = "th" : 0;
	n < 14 && n > 10 ? s = "th" : 0;
	return s;
}
</script>

<body onload="countetm();altstep();" onkeyup="countetm();generate();">
	<table id="table" cellspacing="0" cellpadding="2">
		<tr>
			<td colspan="4">
				<input type="text" id="scr" placeholder="Scramble"/> &nbsp;Solve 
				
				<input type="text" id="sn" value="1" size="3"/> &nbsp;

				
				<label>
					<input type="checkbox" id="vid" checked onclick="altstep()"/> Video
				
				</label>
				<span id="utube">&nbsp;
					
					<input type="text" id="youtube" placeholder="Full URL"/>
				</span>
			</td>
		</tr>
		<tr>
			<td colspan="4">
				<label>
					<input type="checkbox" id="oskip" onclick="altstep()"/>OLL Skip
				
				</label> &nbsp;

				
				<label>
					<input type="checkbox" id="pskip" onclick="altstep()"/>PLL Skip
				
				</label> &nbsp;

				
				<select id="hstm" onchange="countstm();generate()">
					<option value="HTM">HTM</option>
					<option value="STM">STM</option>
				</select> &nbsp;

				
				<select id="tcross" onchange="altstep()">
					<option disabled="disabled"/>cross</option>
				<option value="n" selected="selected">Normal</option>
				<option value="x">X</option>
				<option value="xx">XX</option>
				<option value="xxx">XXX</option>
			</select>
		</td>
		<td id="video"></td>
	</tr>
	<tr>
		<td colspan="4">
			<input type="text" id="solver" placeholder="Solver name" onkeyup="generate()"/>
			<input type="text" id="av" placeholder="avg time" size="6" onkeyup="generate()"/>
			<select id="avsel" onchange="generate()">
				<option value="0">Not an average</option>
				<option value="5" selected="selected">avg5</option>
				<option value="12">avg12</option>
			</select>
			<label>
				<input type="checkbox" id="offic" onchange="generate()"/> Official
			
			</label>
		</td>
	</tr>
	<tr>
		<td>Step Name</td>
		<td>Moves Made</td>
		<td style="width:10px;"></td>
		<td>Time to point</td>
		<td>
			<span style="display:none;"># Turns (STM)</span>
		</td>
		<td>
			<span style="display:none;"># Turns (ETM)</span>
		</td>
	</tr>
	<tr id="r1">
		<td>
			<input type="text" id="s1n" value="inspection" disabled/>
		</td>
		<td>
			<input type="text" id="s1m"/>
		</td>
		<td></td>
		<td>
			<input type="text" id="s1t" value="0" disabled hidden/>
		</td>
		<td>
			<input type="text" id="s1ts" value="0" disabled hidden/>
		</td>
		<td>
			<input type="text" id="s1te" value="0" disabled hidden/>
		</td>
	</tr>
	<tr id="r2">
		<td>
			<input type="text" id="s2n" value="cross" disabled/>
		</td>
		<td>
			<input type="text" id="s2m"/>
		</td>
		<td style="width:10px;border-top:1px solid black;border-right:1px solid black;" id="xborder"></td>
		<td rowspan="2" style="vertical-align:middle;" id="c">
			<input type="text" id="s2t" value="0" hidden disabled/>
			<input type="text" id="s3t" value="0"/>
		</td>
		<td>
			<input type="text" id="s2ts" hidden/>
		</td>
		<td>
			<input type="text" id="s2te" hidden/>
		</td>
	</tr>
	<tr id="r3">
		<td>
			<input type="text" id="s3n" value="1st pair" disabled/>
		</td>
		<td>
			<input type="text" id="s3m"/>
		</td>
		<td style="width:10px;border-bottom:1px solid black;border-right:1px solid black;"></td>
		<td>
			<input type="text" id="s3ts" hidden/>
		</td>
		<td>
			<input type="text" id="s3te" hidden/>
		</td>
	</tr>
	<tr id="r4">
		<td>
			<input type="text" id="s4n" value="2nd pair" disabled/>
		</td>
		<td>
			<input type="text" id="s4m"/>
		</td>
		<td style="width:10px;border-right:1px solid black;"></td>
		<td rowspan="3" style="vertical-align:middle;" id="f2">
			<input type="text" id="s4t" value="0"/>
		</td>
		<td>
			<input type="text" id="s4ts" hidden/>
		</td>
		<td>
			<input type="text" id="s4te" hidden/>
		</td>
	</tr>
	<tr id="r5">
		<td>
			<input type="text" id="s5n" value="3rd pair" disabled/>
		</td>
		<td>
			<input type="text" id="s5m"/>
		</td>
		<td style="width:10px;border-right:1px solid black;"></td>
		<td rowspan="2" id="f3" style="display:hidden;">
			<input type="text" id="s5t" value="0"/>
		</td>
		<td>
			<input type="text" id="s5ts" hidden/>
		</td>
		<td>
			<input type="text" id="s5te" hidden/>
		</td>
	</tr>
	<tr id="r6">
		<td>
			<input type="text" id="s6n" value="4th pair" disabled/>
		</td>
		<td>
			<input type="text" id="s6m"/>
		</td>
		<td style="width:10px;border-bottom:1px solid black;border-right:1px solid black;"></td>
		<td id="f4" style="display:hidden;">
			<input type="text" id="s6t" value="0"/>
		</td>
		<td>
			<input type="text" id="s6ts" hidden/>
		</td>
		<td>
			<input type="text" id="s6te" hidden/>
		</td>
	</tr>
	<tr id="r7">
		<td>
			<input type="text" id="s7n" value="OLL" disabled/>
		</td>
		<td>
			<input type="text" id="s7m"/>
		</td>
		<td style="width:10px;border-right:1px solid black;" id="oborder"></td>
		<td rowspan="2" style="vertical-align:middle;">
			<input type="text" id="s7t" value="0"/>
		</td>
		<td>
			<input type="text" id="s7ts" hidden/>
		</td>
		<td>
			<input type="text" id="s7te" hidden/>
		</td>
	</tr>
	<tr id="r8">
		<td>
			<input type="text" id="s8n" value="PLL" disabled/>
		</td>
		<td>
			<input type="text" id="s8m"/>
		</td>
		<td style="width:10px;border-bottom:1px solid black;border-right:1px solid black;" width="10"></td>
		<td style="vertical-align:middle; display:none;" id="llt2">
			<input type="text" id="s8t" value="0"/>
		</td>
		<td>
			<input type="text" id="s8ts" hidden/>
		</td>
		<td>
			<input type="text" id="s8te" hidden/>
		</td>
	</tr>
</table>
<input type="button" onclick="addsolve()" value="Done with solve"/> &nbsp;

<input type="button" onclick="selectText()" value="Select"/> &nbsp;


<input type="button" onclick="visual();" value="Update Picture"/>
<br/>
<img id="visualcube" src="http://cube.crider.co.uk/visualcube.php?fmt=gif&size=150&co=0&fo=75&alg=x2"/>
<br/>
<div id="full">
	<div id="prespoil"></div>
	<div id="final"></div>
	<div id="solves" style="display:none;"></div>
	<div id="statsa" style="display:none;"></div>
	<div id="post" style="display:none;"></div>
	<div id="link" style="display:none;"></div>
	<br/>
	<div id="stats" style="display:none;"></div>
	<span id="text" style="display:none;"></span>
	<span id="encode" style="display:none;"></span>
</div>

</body>
